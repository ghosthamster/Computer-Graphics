
@{
    ViewBag.Title = "ColorModelM";
}

<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css?family=Avenir&display=swap" rel="stylesheet" />
    <title>Document</title>
    <style>
        * {
            overflow-x: hidden;
            padding: 0px !important;
            margin: 0px !important;
        }

        .v130_0 {
            width: 100%;
            height: 700px;
            background: rgba(239,241,244,1);
            padding: 10px 10px;
            margin: 10px;
            opacity: 1;
            position: absolute;
            top: 0px;
            left: 0px;
            overflow: hidden;
        }

        #myCanvas2 {
            width: 250px;
            height: 250px;
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            opacity: 1;
            position: absolute;
            top: 128px;
            left: 297px;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            overflow: hidden;
        }

        #myCanvas1 {
            width: 250px;
            height: 250px;
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            opacity: 1;
            position: absolute;
            top: 429px;
            left: 297px;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            overflow: hidden;
        }

        .v130_8 {
            width: 210px;
            color: rgba(0,0,0,0.75);
            position: absolute;
            top: 22px;
            left: 471px;
            font-family: Avenir;
            font-weight: Black;
            font-size: 36px;
            opacity: 1;
            text-align: left;
        }

        .v130_9 {
            width: 141px;
            height: 41px;
            background: url("../images/v130_9.png");
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            opacity: 1;
            position: absolute;
            top: 27px;
            left: 22px;
            overflow: hidden;
        }

        .v130_10 {
            width: 33px;
            height: 39px;
            background: url("../images/v130_10.png");
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            opacity: 0.7400000095367432;
            position: absolute;
            top: 1px;
            left: 0px;
            overflow: hidden;
        }

        .v130_11 {
            width: 103px;
            color: rgba(0,0,0,0.75);
            position: absolute;
            top: 0px;
            left: 38px;
            font-family: Avenir;
            font-weight: Book;
            font-size: 30px;
            opacity: 1;
            text-align: left;
        }

        .v130_12 {
            width: 275px;
            height: 615px;
            background: url("../images/v130_12.png");
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            opacity: 1;
            position: absolute;
            top: 85px;
            left: 0px;
            overflow: hidden;
        }

        .v130_13 {
            width: 268px;
            height: 615px;
            background: rgba(228,230,236,1);
            opacity: 1;
            position: absolute;
            top: 0px;
            left: 1px;
            border: 1px solid rgba(0,0,0,0.5);
            border-top-right-radius: 10px;
            overflow: hidden;
        }

        .v130_63 {
            width: 120px;
            color: rgba(0,0,0,0.75);
            position: absolute;
            top: 156px;
            left: 22px;
            font-family: Avenir;
            font-weight: Medium;
            font-size: 25px;
            opacity: 1;
            text-align: left;
        }

        .name {
            color: #fff;
        }

        .v130_99 {
            width: 300px;
            color: rgba(0,0,0,0.75);
            position: absolute;
            top: 550px;
            left: 650px;
            font-family: Avenir;
            font-weight: Medium;
            font-size: 25px;
            opacity: 1;
            text-align: left;
        }

        .v130_98 {
            width: 300px;
            color: rgba(0,0,0,0.75);
            position: absolute;
            top: 220px;
            left: 650px;
            font-family: Avenir;
            font-weight: Medium;
            font-size: 25px;
            opacity: 1;
            text-align: left;
        }

        .v130_49 {
            width: 242px;
            height: 44px;
            background: rgba(28,73,121,1);
            padding: 8px 16px;
            margin: 4px;
            opacity: 1;
            position: absolute;
            top: 425px;
            left: 12px;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .v130_20 {
            width: 242px;
            height: 44px;
            padding: 8px 16px;
            margin: 4px;
            opacity: 1;
            position: absolute;
            top: 360px;
            left: 12px;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            overflow: hidden;
        }

        .v130_50 {
            width: 127px;
            color: rgba(255,255,255,1);
            position: absolute;
            top: 12px;
            left: 65px;
            font-family: Avenir;
            font-weight: Book;
            font-size: 17px;
            opacity: 1;
            text-align: left;
        }

        .v130_51 {
            width: 242px;
            height: 38px;
            background: rgba(28,73,121,1);
            padding: 8px 16px;
            margin: 4px;
            opacity: 1;
            position: absolute;
            top: 511px;
            left: 14px;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .v130_52 {
            width: 88px;
            color: rgba(255,255,255,1);
            position: absolute;
            top: 12px;
            left: 77px;
            font-family: Avenir;
            font-weight: Book;
            font-size: 17px;
            opacity: 1;
            text-align: left;
        }

        .v130_53 {
            width: 88px;
            color: rgba(255,255,255,1);
            position: absolute;
            top: 12px;
            left: 95px;
            font-family: Avenir;
            font-weight: Book;
            font-size: 17px;
            opacity: 1;
            text-align: left;
        }

        .v10_38 {
            top: 80px;
            left: 40px;
            position: absolute;
            overflow: hidden;
            font-family: Avenir;
            font-weight: Book;
            font-size: 18px;
            color: #6C757D;
            background: rgba(255, 255, 255,1);
            width: 92px;
            height: 36px;
            opacity: 1;
            border-radius: 7px;
            margin: 0;
        }

        .name {
            color: #fff;
        }

        .v130_55 {
            width: 70px;
            height: 65px;
            background: url("../images/v130_55.png");
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            opacity: 1;
            position: absolute;
            top: 17px;
            left: 1064px;
            overflow: hidden;
        }

        .v130_56 {
            width: 66px;
            height: 60px;
            background: rgba(226,226,226,1);
            opacity: 1;
            position: absolute;
            top: 0px;
            left: 0px;
            border-radius: 50%;
            box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
        }

        .v130_57 {
            width: 10px;
            height: 10px;
            background: rgba(196,196,196,1);
            opacity: 1;
            position: absolute;
            top: 14px;
            left: 28px;
            border-radius: 50%;
        }

        .v130_58 {
            width: 8px;
            height: 23px;
            background: rgba(196,196,196,1);
            opacity: 1;
            position: absolute;
            top: 26px;
            left: 29px;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            overflow: hidden;
        }

        .v130_73 {
            width: 213px;
            color: rgba(0,0,0,1);
            position: absolute;
            top: 393px;
            left: 682px;
            font-family: Avenir;
            font-weight: Book;
            font-size: 18px;
            opacity: 1;
            text-align: left;
        }

        .v130_74 {
            width: 183px;
            color: rgba(0,0,0,1);
            position: absolute;
            top: 88px;
            left: 661px;
            font-family: Avenir;
            font-weight: Book;
            font-size: 18px;
            opacity: 1;
            text-align: left;
        }

        .dropdown {
            width: 122px;
            height: 100px;
            position: absolute;
            color: .black;
            border-radius: 4px;
            top: 80px;
            left: 40px;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="v130_0">
         <img id="myCanvas2" src="../../Resourses/images/rgb.jpg"></img>
            <img id="myCanvas1" src="../../Resourses/images/HSLColor.jpg"></img>
        <span class="v130_99" id="v130_99">HSL</span>
        <span class="v130_98" id="v130_98">RGB</span>
        <span class="v130_8">Color model</span>
        <div class="v130_9">
            <div class="v130_10">
            </div>
            <span class="v130_11">Back</span>
        </div>
        <div class="v130_12">
            <div class="v130_13"></div>
            <span class="v130_44">Brightness</span>
            <input id="inc" class="v10_38" type="number" value="50" min="0" max="100">
            @using (Html.BeginForm("convert", "ColorModelM",FormMethod.Post,new { enctype = "multipart/form-data" }))
            {
                <input type="file" id="userFIle" name="userFile" class="v130_20" />
                <input type="submit" value="Upload" class="v130_53"/>
            }

            <div class="v130_49" id="v130_49">
                <span class="v130_53">Draw</span>
            </div>
            <a href="/Resourses/images/HSLColor.jpg" download="new-image-name.jpg">
                <div class="v130_51" id="v130_51">
                    <span class="v130_52">Save image </span>
                </div>
            </a>
        </div>
        <div class="v130_55">
            <div class="v130_56"></div>
            <div class="v130_57"></div>
            <div class="v130_58"></div>
        </div>
        <span class="v130_73">HSL</span>
        <span class="v130_74" id="v130_74">RGB</span>
    </div>
    <script>window.addEventListener('load', function () {
            document.querySelector('input[type="file"]').addEventListener('change', function () {
                if (this.files && this.files[0]) {
                    /*var img = document.getElementById('myCanvas2');
                    img.src = URL.createObjectURL(this.files[0]);
                    var path = this.files[0].mozFullPath;
                    var img1 = document.getElementById('myCanvas2');
                    img1.src = URL.createObjectURL(this.files[0]);*/

                    var fd = new FormData();
                    fd.append('file', this.files[0]);
                    var url = 'https://localhost:44322/Upload/';
                    $.ajax({
                        url: url,
                        data: fd,
                        processData: false,
                        contentType: false,
                        type: 'POST',
                        success: function (data) {
                            alert(data);
                        }
                    });

                }
            });
        });
        var draw = document.getElementById('v130_49');

        draw.onclick = function () {
            var bright = parseInt(document.getElementById('inc').value);
            var data = {
                brightnes: bright,
                color: "red"
            }
            $.post("https://localhost:44322/ColorModelM/changebrightnes/", data, function () {
                console.log("success");
            })
                .done(function () { console.log("second success"); })
                .fail(function () { console.log("error"); })
                .always(function () { console.log("finished"); location = location; });
        }

        function rgbToHsl(r, g, b) {
            r /= 255, g /= 255, b /= 255;
            var max = Math.max(r, g, b),
                min = Math.min(r, g, b);
            var h, s, l = (max + min) / 2;

            if (max == min) {
                h = s = 0; // achromatic
            } else {
                var d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r:
                        h = (g - b) / d + (g < b ? 6 : 0);
                        break;
                    case g:
                        h = (b - r) / d + 2;
                        break;
                    case b:
                        h = (r - g) / d + 4;
                        break;
                }
                h /= 6;
            }

            return ({
                h: h,
                s: s,
                l: l,
            });
        }

        var image1 = document.getElementById('myCanvas2');
        image1.onclick = function () {
            var canvas = document.createElement('canvas');
            canvas.width = image1.width;
            canvas.height = image1.height;
            canvas.getContext('2d').drawImage(image1, 0, 0, image1.width, image1.height);
            var pixelData = canvas.getContext('2d').getImageData(event.offsetX, event.offsetY, 1, 1).data;
            var text = document.getElementById('v130_98');
            text.innerHTML = "r = " + pixelData[0] + " g = " + pixelData[1] + " b = " + pixelData[2];
        }

        var image2 = document.getElementById('myCanvas1');
        image2.onclick = function () {
            var canvas = document.createElement('canvas');
            canvas.width = image2.width;
            canvas.height = image2.height;
            canvas.getContext('2d').drawImage(image2, 0, 0, image2.width, image2.height);
            var pixelData = canvas.getContext('2d').getImageData(event.offsetX, event.offsetY, 1, 1).data;
            var text = document.getElementById('v130_99');
            var hsl = rgbToHsl(pixelData[0], pixelData[1], pixelData[2]);
            var hue = hsl.h * 360;
            text.innerHTML = "h = " + hue + " s = " + hsl.s + " l = " + hsl.l;
        }
</script>
</body>
</html>